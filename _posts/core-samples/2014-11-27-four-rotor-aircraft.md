---
layout: post
category : smart hardware
tagline: "四轴飞行器入门"
tags : [ smart hardware ]
---
{% include JB/setup %}

###4轴飞行器原理和组成：

  4轴飞行器的基本配件由机架、电池、电机、电调、飞控、螺旋桨、遥控器、拍摄相机（gopro、摄像头、微单等）组成，原理为遥控器发射遥控型号，遥控接收器收到信号传输给飞控（飞行控制器，等同于电脑的主板），飞控将遥控信号转化传输给电调，电调调节不同电机的供电电流以控制螺旋桨的旋转速度从而完成前后左右，高低上下的飞行动作，而电池负责供电，机架将所有的零件攥在一起,这样飞行器就能带拍摄机器完成在空中的各种拍摄需求

###机架

四轴的机架航模内比较好评的就是大疆450，搭配十寸正反桨。

###电机

如果玩过遥控飞机、遥控汽车的人对于电机并不陌生，有无刷电机和有刷电机之分。电动航模飞机一般采用无刷电机做动力，无刷电机相对有刷电机寿命更长、性能更稳定。

无刷电机型号标称没有一个统一标准，目前比较通用的一种是内径标识法，即标识电机外转子内径，从一定程度上能够表明电机的线圈直径和匝数。经常看人说什么 2212电机，2018电机等等，其实就是电机的尺寸，不管什么牌子的电机，具体都要对应4位这类数字，其中前面2位是电机转子的直径，后面2位是电机转 子的高度。简单来说，前面2位越大、电机越肥，后面2位越大、电机越高。 又高又大的电机，功率就更大，适合做大四轴，通常2212电机是最常见的配置。国产电机品牌新西达、朗宇等是性价比较高的电机品牌，新手用足够了。

一般电机会标识KV值，如“新西达2212 1400KV”，KV值是电机输入电压每提高1v,电机空载转速提高的量。1400KV即说明电机空载情况下，加1V电压，转速为每分钟1400转，2V电压每分钟2800转，依此类推。同型号电机（比如都是2212）低KV值比高KV值的提供的扭力大，类似于汽车1档的速度虽然慢，但是爬坡更容易。但是低KV值需要配大桨，很多机型都不适合，会造成严重的反扭现象。 4轴2212 980KV、2212 1400KV是常用配置。

###电调：

电调全称电子调速器，针对电机不同，可分为有刷电子调速器和无刷电子调速器。它根据控制信号调节电动机的转速。简单来讲它的功能是将电池的直流电转化为三项交流电，并按照接收机的指令调整供给电机的电压，实现电机转速可控。因为电机的电流很大，通常每个电机正常工作时，平均有3A左右的电流，如果没有电调的存在，飞控板根本无法承受这样大的电流（另外也没驱动无刷电机的功能）。同时电调在四轴当中还充当了电压变化器的作用，将11.1v的电压变为低电压为飞控板和遥控器供电。

电调都会标上多少A，如20a，40a
这个数字就是电调能够提供的电流。大电流的电调可以兼容用在小电流的地方，小电流电调不能超标使用。常见新西达2212加1045浆最大电机电流有可能达到了5a，为了保险起见，建议这样配置用 20a 或 40a电调。常见的有好盈、中特威、新西达等品牌。

###电池和充电器：

由于同样的电池容量锂电最轻，起飞效率最高，所以电池一般使用锂聚合物电池，锂聚合物电池单片电压为3.7V，两片或三片串联得到的电压即为上面说到的7.4V或者11.1V。mah表示电池容量，如1000mah电池，即如果以1000ma放电，可持续放电1小时。如果以500mh放电，可以持续放电2小时。

在实际选购过程中电池后面有 2S、3S、5C 等字样，S代表锂电池的节数，锂电池1节标准电压为3.7v，那么3S电池，就是代表有3个3.7v电池在里面，电压为11.1v。C代表电池放电能力，这是普通锂电池和动力锂电池最重要区别，动力锂电池需要很大电流放电，这个放电能力就是C来表示。如1000mah电池标准为5c，那么用5x1000mah，得出电池可以以5000mh的电流强度放电。这很重要，如果用低C的电池，大电流放电，电池会迅速损坏，甚至自燃。与上面的C一样，多少C快充即快速充电的能力，如1000mah电池，2C快充，就代表可以用2000ma的电流来充电。千万不要图快冒然用大电流，超过规定参数充电，电池很容易损坏。

至于怎么配电池这与选择的电机、螺旋桨，想要的飞行时间相关。容量越大，c越高，s越多，电池越重；基本原理是用大桨，因为整体搭配下来功率高，自身升力大，为了保证可玩时间，可选高容量，高c，3s以上电池。常用的四轴电池为20C、3S电池。

有了电池，充电器自然必不可少，一般选用平衡充。如3s电池，内部是3个锂电池，因为制造工艺原因，没办法保证每个电池完全一致，充电放电特性都有差异，电池串联的情况下，就容易造成某些放电过度或充电过度，充电不饱满等，所以解决办法是分别对内部单节电池充电，而平衡充则很好的解决了这个问题。B6平衡充，可以冲好多种电池

###电机与电调、电池间的匹配关系：

首先,你要选择适合你飞机的电机，再选择一个能满足你电机峰值功率的电调，最后选择一个能满足电调峰值功率的电池即可!如电机达最大效率时,电流为 30A，那么你选择的电调起码要30A ,但是一般出去安全考虑,电调要选择大一点的! 如:35A -40A 。电池是根据你的飞机具体来确定用哪种规格，选好规格,那么就可以选择容量倍率了。

###飞行控制板的选择：

性价比比较好的就是APM的飞控400元左右

飞行控制板简称飞控，如果没有飞控板，四轴飞行器就会因为安装、外界干扰、零件之间的不一致型等原因形成飞行力量不平衡，后果就是左右、上下的胡乱翻滚，根本无法飞行，飞控的作用就是通过飞控板上的陀螺仪，对四轴飞行状态进行快速调整，如发现右边力量大，向左倾斜，那么就减弱右边电流输出，电机变慢，升力变小，达到平衡的状态。

购买飞控的时候老板会问你买X模式还是+模式，简单来说X模式要难飞一点，但动作更灵活。+模式要好飞一点，动作灵活差一点，如果飞控板安装错误，会剧烈的晃动，根本无法飞。常见的有KK、FF、玉兔、MMC等品牌，我购买的是MWC10 四轴飞控.

###如何选购螺旋桨

同电机类似，桨也有如1045,7040等4位数字，前面2位代表桨的直径，也就是从桨的一头到另一头的长度，单位是英寸。后面两位数是指几何螺距，螺距原指螺纹上相邻两牙对应点之间的轴向距离，可以理解为螺丝转动一圈，前进的距离。而螺旋桨的螺距，是螺旋桨在固体介质内无摩擦旋转一周所前进的距离。简单来说可以理解为螺旋桨桨叶的“倾斜度”，螺距标称越大，倾斜度越大。桨长度和螺距越大，所需要的电机或发动机级别就越大，桨的长度越大，某种程度上能够保证飞机俯仰稳定性越高，螺距越大，飞行速度越快。

四轴飞行为了抵消螺旋桨的自旋，相隔的桨旋转方向是不一样的，所以需要正反桨。正反桨的风都向下吹。顺时针旋转的叫正浆、逆时针旋转的是反浆。安装的时候，一定记得无论正反桨，有字的一面是向上的。

###电机与螺旋桨的搭配：

    这是非常复杂的问题，建议常见的配置，但原理这里可以阐述一下。螺旋桨越大，升力就越大，但对应需要更大的力量来驱动；螺旋桨转速越高，升力越大；电机的kv越小，转动力量就越大；综上所述，大螺旋桨就需要用低kv电机，小螺旋桨就需要高kv电机（因为需要用转速来弥补升力不足），如果高kv带大桨，力量不够，那么就很困难，实际还是低速运转，电机和电调很容易烧掉。如果低kv带小桨，完全没有问题，但升力不够，可能造成无法起飞。常用1000kv电机，配10寸左右的桨。

###如何选购遥控器：

遥控器从几百到数千不等，常见品牌有国产天地飞，日本futaba等，根据所需通道和预算购买即可。通道就是遥控器控制的动作路数，比如遥控器只能控制四轴上下飞，那么就是1个通道。但四轴在控制过程中需要控制的动作路数有：上下、左右、前后、旋转，所以最低得4通道遥控器。

遥控器有日本手和美国手之分，油门的位置在右边是日本手、在左边是美国手，所谓遥控器油门，在四轴飞行器当中控制供电电流大小，电流大，电动机转得快，飞得高、力量大，反之同理。判断遥控器的油门很简单，遥控器2个摇杆当中，上下板动后不自动回到中间的那个就是油门摇杆。


###减震起落架

四轴新手在操控的时候难免会缺乏经验，加之由于组装机器本身优劣问题并不能保证飞行和降落会非常平稳，为了减少对四轴飞行器的损伤制作一个简易的起落架非常必要。所需材料，碳纤管、起落架、海绵减震套筒等。

###摄像头

云台的摄像头  图传+屏幕

###惯性导航

十轴=三轴加速度+三轴陀螺仪+三轴电子罗盘+高度测量

    三轴加速度+三轴陀螺仪：MPU6050
    三轴电子罗盘：HMC5883L
    高度测量：有用MS5611的，最高精度10cm，高空比较好使，对风比较敏感(推荐)

带有电罗经的GPS，是一个黑色的小蘑菇头一样的东西，用途就是可以测量位置和飞行方向，在飞控上搭载了这个东西可以设置失控自动回家，失控保护，定点定线巡航飞行等等。

有用超声波的，低空精度稍微高一点，貌似能做到1cm，有用光流法的，图像识别定高，对光强比较敏感，需要图像算法基础

###数传

一个挺重要的东西，如果你想实时改变四轴飞行器的飞行轨迹的话这个东西是少不了的用途就是在电脑和四轴上传输数据，控制飞行器按照需要的路线飞行，同时将飞行器的数据反馈给电脑。





###注意事项

* 一定一定先开控再通电！
* 飞行器的重量不要超过四个电机总拉力的2/3，最好不要到1/2。


##飞控总结

从团队选择无人机项目开始，我的前期工作就是了解现在市场上所有的飞控以及功能，为接下来的无人机飞控打下基础。

现在市场上的飞控种类很多，常见的有MK、KK、KK flycam、EAGLE N6、玉兔飞控、FF、WKM、FC1212-S、MWC、FY等等，国内也是有越来越多的团队开始研究四轴飞控，其中很多属于山寨。

###MK

德国的开源项目，但一般价格较贵，整个一套估计要1000多，且对模友的基础要求较高，玩的人不是很多。

###KK

法国的开源项目，国内许多团队利用其开源的特点，将硬件电路和程序照搬过来然后在市场上卖，竞争比较激烈，因此价格很便宜，贵一点的也就100多便宜的只要60左右，目前最新版本是KK5.5，与其他飞控相比，KK飞控只有一个低端的陀螺仪而且不含加速度计，因此不能实现自稳，但价格低廉是其最大的优势，而且支持固定翼模式，很多模友在玩。

###KK flycam

韩国的模友在KK的基础上开发的，添加了加速度计，用了更好一点的陀螺仪，因此能实现自稳，价格为145美元，目前国内卖得一般是其山寨版本，功能差不多，只有280左右。

###EAGLE N6

国内一个团队刚刚研发的，使用的AVR单片机且效果很不错，支持8种飞行模式，每次启动只需要将拨码开关拨至指定模式就完成了模式的切换，且其288元的价格得到了很多模友的追捧，美中不足的是其没有加速度计，不能实现自稳，航拍性能不好。

###玉兔飞控

是近期比较热门的一种飞控，由国外模友研发，采用ARM处理器，售价为288元，性价比较高。

功能特点：

* 主处理器，ARM32位，主频50MHZ
* 可以支持140g的mini小4轴，要知道小4轴比大4轴更“贼”哦。
* 板载高精度数字3轴陀螺仪和3轴加速度计，实现自动稳定和自动平衡。
* 8路接收通道，除了主要的4个摇杆通道外，还可以定义辅助开关通道或云台控制通道。
* 8路16位高精度PWM输出通道，可以定义50Hz～500Hz的模拟/数字舵机或者非标准电调信号
* 输出混控支持（GIMBAL、BI、TRI、QUADP、QUADX、Y4、Y6、HEX6、HEX6X、OCTOX8、OCTOFLATP、OCTOFLATX、FLYING_WING、FIEXD WIND）等模式，还可以根据客户要求增加其它混控模式。
* 自带USB接口，提供PC升级工具，可以方便设定参数，随时下载最新程序，
* 8路LED指示各种状态，方便现场设置参数，达到更细微的调整，还可以外扩彩色LED灯带，实现独特美丽的夜航效果。
* 最多4S电池电压独立检测，保证每个单体电池都不过放。
* 提供报警器接口，提示音方便用户设置和低电压报警，报警提示音回随电压的降低而变得急促。
* 提供超声波接口，实现2米内精确定高（平整地面效果最佳）。
* 开机具有设备自检功能，保障您安全放心飞行，并且自检过程有声光提示过程进展。
* 提供3轴地磁传感器、气压计、GPS等接口，方便用户扩充更多的自动起降定点返航等需求，随时购买附加板并自己在线升级软件即可。
* 软件自主研发，可随时根据国内玩家的要求改进和增加功能。
* 可选多种输出模式：默认电调输出330HZ，舵机输出47HZ信号，舵机/电调输出频率的选择（50Hz（20ms）；100Hz(10ms)；270Hz（3.6ms）；330Hz(3ms)；500Hz(2ms特殊电调)；2KHz PWM（特殊电调））。

规格参数：

* 报警电压的设置：3.4V～3.7V。
* 陀螺仪＋－2000dps，16位分辨率，响应时间1000HZ。
* 加速度计＋-8G、14位分辨率，响应时间800Hz。
* 输入电压：4～6v（由电调提供）。
* 外形：板尺寸5.5mmX5.5mm
* 重量：20g。
* 工作温度：－40～＋85度。

###FF

国内模友开发的一种飞控系统，使用ARM微处理器，200元的价格包含有陀螺仪和加速度计能实现自稳，性价比很高，特别适合新手入门，但其程序不开源，不支持固定翼。

###WKM

[大疆公司](http://item.taobao.com/item.htm?id=12616358824)开发的一种高端飞控，6500元的高价目前主要应用于商业，包含有三轴加速度计，陀螺仪，气压计以及GPS姿态模式，支持四桨、六桨、八桨，自动返航自动降落等等功能，目前在国内属于高端产品。

###FC1212-S

[XAircraft公司](http://xaircraft.taobao.com/)自主开发的飞控，售价为650左右,整套四轴，价格为3500，姿态传感器AHRS-S模块售价为800左右,包含三轴加速度和陀螺仪，整体价格还是很贵，而且其不开源，不支持固定翼模式。

###MWC

法国一个叫Alex的人的开源项目，在国外很受欢迎，目前国内销售的是其山寨版本，不开源，价格从100多到400元都有，支持固定翼，能自稳,国外的开源值得我们去研究

###FY-91Q

飞宇公司自主开发的飞控，其一套系统（包括GPS系统）售价在2500左右，且其不开源，不支持固定翼，能自稳，定点悬停。


###参考

《惯性导航》秦永元

这本书是惯性导航算法的基础。最为基本的惯性导航算法都在这里面有介绍。不过难度较高，里面相当一部分算法看看就好，不必要较真。掌握姿态解算的基本概念，剩下的结合自己的理解手动编程就好。

《3D数学基础：图形与游戏开发》

没错，这本书其实是讲游戏开发的……
不过惯性导航，其实就是那三个传感器的坐标轴不断转换，飞行器不断旋转的过程。在这之中，四元数算法是使用的最多的一种算法，而这本书对四元数有非常详尽的讲解和实例。不管是游戏还是飞行器，最基本的数学知识都是一样的~


《Modeling and Adaptive Control of a Quadrotor》 by Matthias Schreier

http://image.fengniao.com/437/4371228.html

http://www.zhihu.com/question/21775696
